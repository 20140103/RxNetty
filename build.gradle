// Establish version and status
ext.githubProjectName = rootProject.name // Change if github project name is not the same as the root project's name
group = "com.netflix.${githubProjectName}"

buildscript {
    repositories {
        mavenLocal()
        mavenCentral() // maven { url 'http://jcenter.bintray.com' }
    }
    apply from: file('gradle/buildscript.gradle'), to: buildscript 
}

allprojects {
    repositories { 
        mavenLocal()
        mavenCentral() // maven { url: 'http://jcenter.bintray.com' }
    }
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'eclipse'
    apply plugin: 'idea'

    group = "com.netflix.rxjava"
	
	// make 'examples' use the same classpath
	configurations {
	    // add new configuration
	    examples

	    //adding a configuration that extends existing configuration:
	    //(testCompile was added by the java plugin)
	    examples.extendsFrom(compile)
	    examplesCompile.extendsFrom(compile)
        examplesRuntime.extendsFrom runtime
	}

    sourceSets.test.java.srcDir 'src/main/java'

    tasks.withType(Javadoc).each {
        it.classpath = sourceSets.main.compileClasspath
    }

    //include /src/examples folder
	sourceSets {
        examples {
            // no idea why this is needed
            java.srcDirs = []
        }
	}
    
    //include 'examples' in build task
    tasks.build { 
        dependsOn(examplesClasses)
    }
    
    eclipse {  
        classpath {  
            // include 'provided' dependencies on the classpath
            plusConfigurations += configurations.provided
            plusConfigurations += configurations.examples
            
            downloadSources = true
            downloadJavadoc = true
        }
    }
    
    idea {
        module {
            // include 'provided' dependencies on the classpath
            scopes.PROVIDED.plus += configurations.provided
            scopes.PROVIDED.plus += configurations.provided
        }
    }
}

dependencies {
    compile 'javax.ws.rs:jsr311-api:1.1.1'
    compile 'com.sun.jersey:jersey-core:1.11'
    compile 'com.sun.jersey:jersey-server:1.11'
    compile 'com.sun.jersey:jersey-servlet:1.11'
    testCompile 'org.testng:testng:6.1.1'
    testCompile 'org.mockito:mockito-core:1.8.5'
}
